import{r as o,u as B,j as e,J as k,X as V,H as Q,D as Z,T as O,B as ee,M as te,i as R}from"./index-BYBhPLOX.js";import{c as x,a as M,f as se}from"./formatters-UyfiUF7z.js";import{D as ae}from"./download-CZ7FYZO4.js";import{U as re}from"./upload-BUnirlcS.js";import{P as T}from"./plus-CjBnM4MQ.js";import{S as ne}from"./save-BfZ7pjXb.js";import{P as le}from"./piggy-bank-C-QXPtj_.js";import{T as ie}from"./trending-down-BaR_FbPx.js";import{R as S,C as oe,X as ce,Y as de,T as z,L as me,c as $}from"./generateCategoricalChart-DhUO3NK-.js";import{A as ue}from"./AreaChart-B6-uPhhY.js";import{A as E}from"./Area-D0doveRy.js";import{P as F,a as G}from"./PieChart-BlrihP7L.js";import{P as he}from"./pen-BI9XVCxa.js";import"./PolarAngleAxis-BXx4qAgt.js";function we(){const[r,g]=o.useState([]),[L,f]=o.useState(!1),[p,D]=o.useState(null),[y,b]=o.useState({isOpen:!1,id:null,name:""}),[w,U]=o.useState(!1),[l,v]=o.useState({name:"",address:"",type:"apartment",purchasePrice:"",currentPrice:"",loanAmount:"",purchaseDate:"",area:"",notes:""});o.useEffect(()=>{const t=localStorage.getItem("portfolio_properties");if(t)try{g(JSON.parse(t))}catch(s){B.error("포트폴리오 데이터 로드 실패:",s)}U(!0)},[]),o.useEffect(()=>{w&&(r.length>0?localStorage.setItem("portfolio_properties",JSON.stringify(r)):localStorage.removeItem("portfolio_properties"))},[r,w]);const u=o.useCallback((t,s)=>{v(a=>({...a,[t]:s}))},[]),j=o.useCallback(()=>{v({name:"",address:"",type:"apartment",purchasePrice:"",currentPrice:"",loanAmount:"",purchaseDate:"",area:"",notes:""}),f(!1),D(null)},[]),W=o.useCallback(()=>{if(!l.name||!l.purchasePrice){alert("물건명과 매입가는 필수입니다.");return}const t=Number(l.purchasePrice),s=Number(l.currentPrice),a=Number(l.loanAmount),n=Number(l.area);if(t<0||s<0||a<0||n<0){alert("금액과 면적은 음수일 수 없습니다.");return}if(t>1e10){alert("매입가가 너무 큽니다. 단위를 확인해주세요 (만원)");return}const c={id:p||Date.now(),...l,purchasePrice:Number(l.purchasePrice)||0,currentPrice:Number(l.currentPrice)||Number(l.purchasePrice)||0,loanAmount:Number(l.loanAmount)||0,area:Number(l.area)||0,createdAt:p?void 0:new Date().toISOString(),updatedAt:new Date().toISOString()};g(p?i=>i.map(d=>d.id===p?{...d,...c}:d):i=>[...i,c]),j()},[l,p,j]),q=o.useCallback(t=>{v({name:t.name,address:t.address,type:t.type,purchasePrice:t.purchasePrice,currentPrice:t.currentPrice,loanAmount:t.loanAmount,purchaseDate:t.purchaseDate,area:t.area,notes:t.notes||""}),D(t.id),f(!0)},[]),J=o.useCallback(t=>{b({isOpen:!0,id:t.id,name:t.name})},[]),K=o.useCallback(()=>{g(t=>t.filter(a=>a.id!==y.id)),b({isOpen:!1,id:null,name:""})},[y.id]),A=o.useCallback(()=>{b({isOpen:!1,id:null,name:""})},[]),X=o.useCallback(()=>{if(r.length===0){alert("내보낼 자산이 없습니다.");return}const t={version:"1.0",exportDate:new Date().toISOString(),properties:r},s=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),a=URL.createObjectURL(s),n=document.createElement("a");n.href=a,n.download=`portfolio-${new Date().toISOString().split("T")[0]}.json`,n.click(),URL.revokeObjectURL(a)},[r]),Y=o.useCallback(t=>{var n;const s=(n=t.target.files)==null?void 0:n[0];if(!s)return;const a=new FileReader;a.onload=c=>{try{const i=JSON.parse(c.target.result);i.properties&&Array.isArray(i.properties)?confirm(`${i.properties.length}개의 자산을 가져오시겠습니까?
기존 데이터는 유지됩니다.`)&&g(h=>{const P=i.properties.map(_=>({..._,id:Date.now()+Math.random(),importedAt:new Date().toISOString()}));return[...h,...P]}):alert("올바른 포트폴리오 파일 형식이 아닙니다.")}catch(i){B.error("포트폴리오 가져오기 실패:",i),alert("파일을 읽는 중 오류가 발생했습니다.")}},a.readAsText(s),t.target.value=""},[]),m=o.useMemo(()=>{const t=r.reduce((d,h)=>d+(h.purchasePrice||0),0),s=r.reduce((d,h)=>d+(h.currentPrice||0),0),a=r.reduce((d,h)=>d+(h.loanAmount||0),0),n=s-a,c=s-t,i=t>0?c/t*100:0;return{totalPurchase:t,totalCurrent:s,totalLoan:a,totalEquity:n,totalGain:c,returnRate:i}},[r]),N=o.useMemo(()=>{const t={apartment:"아파트",officetel:"오피스텔",villa:"빌라",land:"토지",commercial:"상가"},s=r.reduce((a,n)=>(a[n.type]=(a[n.type]||0)+(n.currentPrice||0),a),{});return Object.entries(s).map(([a,n])=>({name:t[a]||a,value:n,color:{apartment:"#6366f1",officetel:"#8b5cf6",villa:"#ec4899",land:"#10b981",commercial:"#f59e0b"}[a]}))},[r]),C=o.useMemo(()=>{const t=r.reduce((a,n)=>{var i;const c=((i=n.address)==null?void 0:i.split(" ")[0])||"기타";return a[c]=(a[c]||0)+(n.currentPrice||0),a},{}),s=["#6366f1","#8b5cf6","#ec4899","#10b981","#f59e0b","#ef4444"];return Object.entries(t).map(([a,n],c)=>({name:a,value:n,color:s[c%s.length]}))},[r]),H=o.useMemo(()=>{if(r.length===0)return[];const t=[],s=new Date,a=r.reduce((i,d)=>i+(d.purchasePrice||0),0),n=[.98,1.01,.99,1.02,1,1.01,.99,1.03,1.01,1.02,1,1.01];let c=1;for(let i=11;i>=0;i--){const d=new Date(s.getFullYear(),s.getMonth()-i,1),h=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`,P=(11-i+Math.floor(a/1e4))%n.length;c*=n[P],t.push({month:h,value:Math.round(m.totalCurrent*c),equity:Math.round(m.totalEquity*c)})}return t},[r,m]),I=[{value:"apartment",label:"아파트"},{value:"officetel",label:"오피스텔"},{value:"villa",label:"빌라/다세대"},{value:"land",label:"토지"},{value:"commercial",label:"상가/오피스"}];return e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"page-title",children:[e.jsx(k,{size:28}),"포트폴리오 관리"]}),e.jsx("p",{className:"page-subtitle",children:"보유 부동산 자산을 관리하고 수익률을 추적하세요"})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:X,style:{display:"flex",alignItems:"center",gap:6},disabled:r.length===0,title:"포트폴리오 내보내기",children:[e.jsx(ae,{size:16}),"내보내기"]}),e.jsxs("label",{className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},title:"포트폴리오 가져오기",children:[e.jsx(re,{size:16}),"가져오기",e.jsx("input",{type:"file",accept:".json",onChange:Y,style:{display:"none"}})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>f(!0),style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(T,{size:18}),"자산 추가"]})]})]}),L&&e.jsx("div",{className:"modal-overlay",onClick:j,children:e.jsxs("div",{className:"modal-content",onClick:t=>t.stopPropagation(),style:{maxWidth:600},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:p?"자산 수정":"새 자산 추가"}),e.jsx("button",{className:"btn-icon",onClick:j,children:e.jsx(V,{size:20})})]}),e.jsxs("div",{className:"modal-body",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"물건명 *"}),e.jsx("input",{type:"text",value:l.name,onChange:t=>u("name",t.target.value),placeholder:"예: 강남구 래미안"})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"주소"}),e.jsx("input",{type:"text",value:l.address,onChange:t=>u("address",t.target.value),placeholder:"예: 서울시 강남구 삼성동"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"유형"}),e.jsx("select",{value:l.type,onChange:t=>u("type",t.target.value),children:I.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"면적 (㎡)"}),e.jsx("input",{type:"number",value:l.area,onChange:t=>u("area",t.target.value),placeholder:"84"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"매입가 (만원) *"}),e.jsx("input",{type:"number",value:l.purchasePrice,onChange:t=>u("purchasePrice",t.target.value),placeholder:"100000"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"현재 시세 (만원)"}),e.jsx("input",{type:"number",value:l.currentPrice,onChange:t=>u("currentPrice",t.target.value),placeholder:"120000"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"대출 잔액 (만원)"}),e.jsx("input",{type:"number",value:l.loanAmount,onChange:t=>u("loanAmount",t.target.value),placeholder:"50000"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"취득일"}),e.jsx("input",{type:"date",value:l.purchaseDate,onChange:t=>u("purchaseDate",t.target.value)})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"메모"}),e.jsx("textarea",{value:l.notes,onChange:t=>u("notes",t.target.value),placeholder:"추가 정보를 입력하세요",rows:2})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:j,children:"취소"}),e.jsxs("button",{className:"btn btn-primary",onClick:W,children:[e.jsx(ne,{size:16})," 저장"]})]})]})}),e.jsxs("div",{className:"stats-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:24,marginBottom:32},children:[e.jsxs("div",{className:"stat-card glass-card",style:{padding:24},children:[e.jsx("div",{className:"stat-icon",style:{background:"linear-gradient(135deg, #6366f1, #8b5cf6)",marginBottom:16},children:e.jsx(Q,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-label",style:{marginBottom:8,display:"block"},children:"보유 자산"}),e.jsxs("span",{className:"stat-value",style:{fontSize:"1.75rem"},children:[r.length,"건"]})]})]}),e.jsxs("div",{className:"stat-card glass-card",style:{padding:24},children:[e.jsx("div",{className:"stat-icon",style:{background:"linear-gradient(135deg, #10b981, #14b8a6)",marginBottom:16},children:e.jsx(Z,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-label",style:{marginBottom:8,display:"block"},children:"총 자산가치"}),e.jsx("span",{className:"stat-value",style:{fontSize:"1.5rem"},children:x(m.totalCurrent)})]})]}),e.jsxs("div",{className:"stat-card glass-card",style:{padding:24},children:[e.jsx("div",{className:"stat-icon",style:{background:"linear-gradient(135deg, #f59e0b, #f97316)",marginBottom:16},children:e.jsx(le,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-label",style:{marginBottom:8,display:"block"},children:"순자산 (자산-대출)"}),e.jsx("span",{className:"stat-value",style:{fontSize:"1.5rem"},children:x(m.totalEquity)})]})]}),e.jsxs("div",{className:"stat-card glass-card",style:{padding:24},children:[e.jsx("div",{className:"stat-icon",style:{background:m.totalGain>=0?"linear-gradient(135deg, #10b981, #34d399)":"linear-gradient(135deg, #ef4444, #f87171)",marginBottom:16},children:m.totalGain>=0?e.jsx(O,{size:24}):e.jsx(ie,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-label",style:{marginBottom:8,display:"block"},children:"총 수익"}),e.jsxs("span",{className:"stat-value",style:{color:m.totalGain>=0?"var(--color-success)":"var(--color-danger)",fontSize:"1.25rem"},children:[x(m.totalGain),e.jsx("span",{style:{marginLeft:8,fontSize:"0.9rem",padding:"4px 8px",borderRadius:"var(--radius-sm)",background:m.totalGain>=0?"var(--color-success-light)":"var(--color-danger-light)"},children:M(m.returnRate)})]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(450px, 1fr))",gap:28,marginBottom:32},children:[e.jsxs("div",{className:"glass-card",style:{padding:28},children:[e.jsxs("h3",{style:{marginBottom:20,display:"flex",alignItems:"center",gap:10,fontSize:"1.1rem"},children:[e.jsx(O,{size:22})," 자산 가치 추이",e.jsx("span",{style:{fontSize:"0.7rem",padding:"2px 8px",borderRadius:12,background:"var(--color-warning-light)",color:"var(--color-warning)",fontWeight:500,marginLeft:"auto"},children:"예상 추이 (시뮬레이션)"})]}),e.jsx(S,{width:"100%",height:250,children:e.jsxs(ue,{data:H,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"valueGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#6366f1",stopOpacity:0})]})}),e.jsx(oe,{strokeDasharray:"3 3",stroke:"var(--color-border)"}),e.jsx(ce,{dataKey:"month",tick:{fontSize:12},stroke:"var(--color-text-secondary)"}),e.jsx(de,{tickFormatter:t=>xe(t),tick:{fontSize:12},stroke:"var(--color-text-secondary)"}),e.jsx(z,{formatter:t=>x(t)}),e.jsx(E,{type:"monotone",dataKey:"value",stroke:"#6366f1",fill:"url(#valueGradient)",name:"총 자산"}),e.jsx(E,{type:"monotone",dataKey:"equity",stroke:"#10b981",fill:"none",name:"순자산"}),e.jsx(me,{})]})})]}),e.jsxs("div",{className:"glass-card",style:{padding:28},children:[e.jsxs("h3",{style:{marginBottom:20,display:"flex",alignItems:"center",gap:10,fontSize:"1.1rem"},children:[e.jsx(ee,{size:22})," 유형별 분포"]}),N.length>0?e.jsx(S,{width:"100%",height:250,children:e.jsxs(F,{children:[e.jsx(G,{data:N,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",label:({name:t,percent:s})=>`${t} ${(s*100).toFixed(0)}%`,children:N.map((t,s)=>e.jsx($,{fill:t.color},s))}),e.jsx(z,{formatter:t=>x(t)})]})}):e.jsx("div",{style:{height:250,display:"flex",alignItems:"center",justifyContent:"center",color:"var(--color-text-secondary)"},children:"자산을 추가해주세요"})]}),e.jsxs("div",{className:"glass-card",style:{padding:28},children:[e.jsxs("h3",{style:{marginBottom:20,display:"flex",alignItems:"center",gap:10,fontSize:"1.1rem"},children:[e.jsx(te,{size:22})," 지역별 분포"]}),C.length>0?e.jsx(S,{width:"100%",height:250,children:e.jsxs(F,{children:[e.jsx(G,{data:C,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",label:({name:t,percent:s})=>`${t} ${(s*100).toFixed(0)}%`,children:C.map((t,s)=>e.jsx($,{fill:t.color},s))}),e.jsx(z,{formatter:t=>x(t)})]})}):e.jsx("div",{style:{height:250,display:"flex",alignItems:"center",justifyContent:"center",color:"var(--color-text-secondary)"},children:"자산을 추가해주세요"})]})]}),e.jsxs("div",{className:"glass-card",style:{padding:28},children:[e.jsxs("h3",{style:{marginBottom:24,display:"flex",alignItems:"center",gap:10,fontSize:"1.1rem"},children:[e.jsx(k,{size:22})," 보유 자산 목록"]}),r.length>0?e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"물건명"}),e.jsx("th",{children:"유형"}),e.jsx("th",{children:"주소"}),e.jsx("th",{children:"매입가"}),e.jsx("th",{children:"현재 시세"}),e.jsx("th",{children:"대출"}),e.jsx("th",{children:"수익률"}),e.jsx("th",{children:"관리"})]})}),e.jsx("tbody",{children:r.map(t=>{var n;const s=(t.currentPrice||0)-(t.purchasePrice||0),a=t.purchasePrice>0?s/t.purchasePrice*100:0;return e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:600},children:t.name}),e.jsx("td",{children:((n=I.find(c=>c.value===t.type))==null?void 0:n.label)||t.type}),e.jsx("td",{style:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis"},children:t.address||"-"}),e.jsx("td",{children:x(t.purchasePrice)}),e.jsx("td",{children:x(t.currentPrice)}),e.jsx("td",{children:x(t.loanAmount)}),e.jsx("td",{style:{color:s>=0?"var(--color-success)":"var(--color-danger)",fontWeight:600},children:M(a)}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn-icon",onClick:()=>q(t),title:"수정",children:e.jsx(he,{size:16})}),e.jsx("button",{className:"btn-icon",onClick:()=>J(t),title:"삭제",style:{color:"var(--color-danger)"},"aria-label":`${t.name} 삭제`,children:e.jsx(R,{size:16})})]})})]},t.id)})})]})}):e.jsxs("div",{className:"empty-state-enhanced",children:[e.jsx("div",{className:"empty-icon",children:e.jsx(k,{size:36})}),e.jsx("h3",{children:"아직 등록된 자산이 없습니다"}),e.jsx("p",{children:"부동산 자산을 추가하여 포트폴리오를 관리하고 수익률을 실시간으로 추적해보세요."}),e.jsxs("button",{className:"btn btn-primary btn-lg",onClick:()=>f(!0),children:[e.jsx(T,{size:20}),"첫 번째 자산 추가하기"]})]})]}),y.isOpen&&e.jsx("div",{className:"modal-overlay",onClick:A,children:e.jsxs("div",{className:"modal-content",onClick:t=>t.stopPropagation(),style:{maxWidth:400,textAlign:"center"},children:[e.jsxs("div",{style:{padding:"24px 24px 0"},children:[e.jsx("div",{style:{width:60,height:60,borderRadius:"50%",background:"var(--color-danger-light)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:e.jsx(R,{size:28,style:{color:"var(--color-danger)"}})}),e.jsx("h3",{style:{marginBottom:8},children:"자산 삭제"}),e.jsxs("p",{style:{color:"var(--color-text-secondary)",marginBottom:24},children:[e.jsxs("strong",{children:['"',y.name,'"']}),"을(를) 정말 삭제하시겠습니까?",e.jsx("br",{}),"이 작업은 취소할 수 없습니다."]})]}),e.jsxs("div",{style:{display:"flex",gap:12,padding:"0 24px 24px",justifyContent:"center"},children:[e.jsx("button",{className:"btn btn-secondary",onClick:A,children:"취소"}),e.jsx("button",{className:"btn",onClick:K,style:{background:"var(--color-danger)",color:"white"},children:"삭제"})]})]})})]})}function xe(r){return r>=1e5?`${(r/1e4).toFixed(0)}억`:r>=1e4?`${(r/1e4).toFixed(1)}억`:`${se(r)}만`}export{we as default};
//# sourceMappingURL=PortfolioManager-DCXwCsF3.js.map
